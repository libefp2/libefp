EFPMD ver. 2.0.0
Copyright (c) 2012-2017 Ilya Kaliman, 2017-2024 Lyudmila Slipchenko

LIBEFP ver. 2.0.0
Copyright (c) 2012-2017 Ilya Kaliman
              2018-2022 Lyudmila Slipchenko

Journal References:
  - Kaliman and Slipchenko, JCC 2013.
    DOI: http://dx.doi.org/10.1002/jcc.23375
  - Kaliman and Slipchenko, JCC 2015.
    DOI: http://dx.doi.org/10.1002/jcc.23772

Project web site: https://github.com/libefp2/libefp/

RUNNING 1 MPI PROCESSES WITH 32 OPENMP THREADS EACH
WALL CLOCK TIME IS Mon Apr 14 12:58:56 2025

SIMULATION SETTINGS

run_type md
coord xyzabc
terms elec pol disp xr
special_terms elec pol disp xr
elec_damp screen
disp_damp overlap
pol_damp tt
pol_driver iterative
enable_ff false
enable_multistep false
ff_geometry ff.xyz
ff_parameters /../fraglib/params/amber99.prm
single_params_file false
efp_params_file params.efp
enable_cutoff false
swf_cutoff 10
xr_cutoff 10
max_steps 10
multistep_steps 1
fraglib_path ../fraglib
userlib_path .
enable_pbc false
periodic_box 30.0 30.0 30.0 90.0 90.0 90.0
opt_tol 0.0003
opt_energy_tol 1e-06
gtest_tol 1e-06
ref_energy 0
hess_central false
num_step_dist 0.001
num_step_angle 0.01
ensemble nve
time_step 1
print_step 1
velocitize false
temperature 300
pressure 1
thermostat_tau 1000
barostat_tau 10000
ligand -100
enable_pairwise false
print_pbc false
symmetry false
special_fragment 0
enable_torch true
enable_elpot false
opt_special_frag 0
torch_nn ani1.pt
ml_path ../nnlib/
userml_path .
custom_nn custom_model_script.pt
aev_nn aev_scripted.pt
atom_gradient frag
symm_frag frag
update_params 0
update_params_cutoff 0
print 0


Chosen nn_type: ani1.pt
The location of NN potential is: ../nnlib/
Model loaded from: ../nnlib/ANI1x_saved2.pt

MOLECULAR DYNAMICS JOB


Inside md_create(), Torch enabled
In md_create(), (body->atoms[i]).atom_velo     0.0000000000     0.0000000000     0.0005000000
In md_create(), (body->atoms[i]).atom_velo     0.0000000000     0.0000000000     0.0005000000
In md_create(), (body->atoms[i]).atom_velo     0.0000000000     0.0000000000     0.0005000000
md->n_freedom =   15
Inside compute forces, Torch enabled
Setting special fragments as Torch coordinates
tG_double Gradients:
    0.0000000000	   -0.0396314705	    0.0000000000	
    0.0202517875	    0.0198157353	    0.0000000000	
   -0.0202517875	    0.0198157353	    0.0000000000	

Torch gradient in energy.c
0.000000 -0.039631 0.000000 0.020252 0.019816 0.000000 -0.020252 0.019816 0.000000 
EFP fragment atomic gradient
0.000011 -0.001900 0.013652 0.000003 -0.000123 -0.002694 0.000003 -0.000116 -0.002698 

====Torch grad + EFP grad ===
0.000011 -0.041531 0.013652 0.020255 0.019692 -0.002694 -0.020248 0.019700 -0.002698 
=================================
    INITIAL STATE

    GEOMETRY (ANGSTROMS)

A01O1                0.000000     0.063030     0.000000
A02H2               -0.752652    -0.500166     0.000000
A03H3                0.752652    -0.500166     0.000000
A01N1                0.000000     0.000000     2.936823
A02H2               -0.466791    -0.808506     3.292603
A03H3               -0.466791     0.808506     3.292603
A04H4                0.933582     0.000000     3.292603


    RESTART DATA

fragment H2O_L
   0.000000e+00   0.000000e+00   0.000000e+00   3.141593e+00   1.570796e+00   0.000000e+00
velocity
   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00

fragment NH3_L
   0.000000e+00   0.000000e+00   3.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00
velocity
   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00


Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0000000000
Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0000000000
Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0000000000
    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0031553188
           POLARIZATION ENERGY    -0.0008033101
             DISPERSION ENERGY    -0.0024607598
     EXCHANGE REPULSION ENERGY     0.0067906511
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY     0.0000000000
                     LJ ENERGY     0.0000000000

                     ML ENERGY   -76.3870240109

                  TOTAL ENERGY   -76.3803421108


                KINETIC ENERGY     0.0041039053
                     INVARIANT   -76.3762382055
               TEMPERATURE (K)   172.7881138830


 time_step =    41.3413733366
Doing update_step_nve, Using Enable-Torch
body->mass 31037.4928179414
Full position update.. will update special fragment
special_atom-mass    15.9949100000
In update_step_nve() part-1, (body->atoms[i]).atom_vel    -0.0000000078     0.0000294433     0.0004903212
special_atom-mass     1.0078250000
In update_step_nve() part-1, (body->atoms[i]).atom_vel    -0.0002279017    -0.0002215677     0.0005303139
special_atom-mass     1.0078250000
In update_step_nve() part-1, (body->atoms[i]).atom_vel     0.0002278235    -0.0002216515     0.0005303561
Updating fragment using update_special_fragment routine()
Inside compute forces, Torch enabled
Setting special fragments as Torch coordinates
tG_double Gradients:
   -0.0000000343	   -0.0291862652	    0.0000449262	
    0.0129486143	    0.0145931159	   -0.0000224552	
   -0.0129485798	    0.0145931484	   -0.0000224710	

Torch gradient in energy.c
-0.000000 -0.029186 0.000045 0.012949 0.014593 -0.000022 -0.012949 0.014593 -0.000022 
EFP fragment atomic gradient
0.000011 -0.001930 0.013976 0.000004 -0.000131 -0.002691 0.000004 -0.000123 -0.002695 

====Torch grad + EFP grad ===
0.000011 -0.031116 0.014021 0.012952 0.014462 -0.002714 -0.012945 0.014470 -0.002717 
=================================
In update_step_nve() part-2, (body->atoms[i]).atom_vel    -0.0000000156     0.0000515029     0.0004803812
In update_step_nve() part-2, (body->atoms[i]).atom_vel    -0.0003736330    -0.0003842889     0.0005608467
In update_step_nve() part-2, (body->atoms[i]).atom_vel     0.0003734740    -0.0003844590     0.0005609289
    STATE AFTER 1 STEPS

    GEOMETRY (ANGSTROMS)

A01O1               -0.000000     0.063674     0.010727
A02H2               -0.757638    -0.505013     0.011602
A03H3                0.757636    -0.505015     0.011603
A01N1                0.000001    -0.000059     2.936943
A02H2               -0.466793    -0.808410     3.293071
A03H3               -0.466794     0.808602     3.292368
A04H4                0.933580     0.000097     3.292731


    RESTART DATA

fragment H2O_L
   0.000000e+00   0.000000e+00   0.000000e+00   3.141593e+00   1.570796e+00   0.000000e+00
velocity
   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00

fragment NH3_L
   2.609949e-07  -3.116618e-05   3.000120e+00  -3.123791e+00   4.346806e-04   3.123791e+00
velocity
   2.409398e-08  -2.879126e-06   1.122205e-05  -2.124096e-05  -3.780136e-07   3.889300e-08


Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0000089618
Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0000089618
Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0000089618
    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0031945092
           POLARIZATION ENERGY    -0.0008267126
             DISPERSION ENERGY    -0.0025158314
     EXCHANGE REPULSION ENERGY     0.0070304555
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY     0.0000000000
                     LJ ENERGY     0.0000000000

                     ML ENERGY   -76.3876928262

                  TOTAL ENERGY   -76.3808104055


                KINETIC ENERGY     0.0045131136
                     INVARIANT   -76.3762972918
               TEMPERATURE (K)   190.0171511062


 time_step =    41.3413733366
Doing update_step_nve, Using Enable-Torch
body->mass 31037.4928179414
Full position update.. will update special fragment
special_atom-mass    15.9949100000
In update_step_nve() part-1, (body->atoms[i]).atom_vel    -0.0000000235     0.0000735625     0.0004704411
special_atom-mass     1.0078250000
In update_step_nve() part-1, (body->atoms[i]).atom_vel    -0.0005193642    -0.0005470101     0.0005913796
special_atom-mass     1.0078250000
In update_step_nve() part-1, (body->atoms[i]).atom_vel     0.0005191245    -0.0005472664     0.0005915017
Updating fragment using update_special_fragment routine()
Inside compute forces, Torch enabled
Setting special fragments as Torch coordinates
tG_double Gradients:
   -0.0000000325	   -0.0068641576	    0.0000415253	
   -0.0023661989	    0.0034320896	   -0.0000207682	
    0.0023662314	    0.0034320680	   -0.0000207571	

Torch gradient in energy.c
-0.000000 -0.006864 0.000042 -0.002366 0.003432 -0.000021 0.002366 0.003432 -0.000021 
EFP fragment atomic gradient
0.000011 -0.001966 0.014295 0.000004 -0.000150 -0.002675 0.000004 -0.000141 -0.002678 

====Torch grad + EFP grad ===
0.000011 -0.008830 0.014336 -0.002362 0.003282 -0.002696 0.002370 0.003291 -0.002698 
=================================
In update_step_nve() part-2, (body->atoms[i]).atom_vel    -0.0000000312     0.0000798228     0.0004602777
In update_step_nve() part-2, (body->atoms[i]).atom_vel    -0.0004927838    -0.0005839427     0.0006217097
In update_step_nve() part-2, (body->atoms[i]).atom_vel     0.0004924581    -0.0005842909     0.0006218630
    STATE AFTER 2 STEPS

    GEOMETRY (ANGSTROMS)

A01O1               -0.000001     0.065283     0.021019
A02H2               -0.769000    -0.516980     0.024539
A03H3                0.768993    -0.516988     0.024543
A01N1                0.000003    -0.000237     2.937314
A02H2               -0.466797    -0.808118     3.294499
A03H3               -0.466802     0.808891     3.291659
A04H4                0.933574     0.000391     3.293123


    RESTART DATA

fragment H2O_L
   0.000000e+00   0.000000e+00   0.000000e+00   3.141593e+00   1.570796e+00   0.000000e+00
velocity
   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00

fragment NH3_L
   1.054204e-06  -1.259728e-04   3.000491e+00  -3.123796e+00   1.756539e-03   3.123799e+00
velocity
   4.863381e-08  -5.836936e-06   2.289815e-05  -4.308133e-05  -7.644902e-07   8.032335e-08


Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0000370595
Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0000370595
Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0000370595
    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0032716566
           POLARIZATION ENERGY    -0.0008543459
             DISPERSION ENERGY    -0.0025694194
     EXCHANGE REPULSION ENERGY     0.0072673056
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY     0.0000000000
                     LJ ENERGY     0.0000000000

                     ML ENERGY   -76.3883699694

                  TOTAL ENERGY   -76.3812547725


                KINETIC ENERGY     0.0049828795
                     INVARIANT   -76.3762718930
               TEMPERATURE (K)   209.7958621775


 time_step =    41.3413733366
Doing update_step_nve, Using Enable-Torch
body->mass 31037.4928179414
Full position update.. will update special fragment
special_atom-mass    15.9949100000
In update_step_nve() part-1, (body->atoms[i]).atom_vel    -0.0000000390     0.0000860830     0.0004501142
special_atom-mass     1.0078250000
In update_step_nve() part-1, (body->atoms[i]).atom_vel    -0.0004662034    -0.0006208754     0.0006520398
special_atom-mass     1.0078250000
In update_step_nve() part-1, (body->atoms[i]).atom_vel     0.0004657917    -0.0006213154     0.0006522244
Updating fragment using update_special_fragment routine()
Inside compute forces, Torch enabled
Setting special fragments as Torch coordinates
tG_double Gradients:
   -0.0000000749	    0.0135710329	   -0.0001803150	
   -0.0157738955	   -0.0067852587	    0.0000900791	
    0.0157739704	   -0.0067857742	    0.0000902359	

Torch gradient in energy.c
-0.000000 0.013571 -0.000180 -0.015774 -0.006785 0.000090 0.015774 -0.006786 0.000090 
EFP fragment atomic gradient
0.000011 -0.001999 0.014617 0.000004 -0.000178 -0.002668 0.000004 -0.000169 -0.002670 

====Torch grad + EFP grad ===
0.000011 0.011572 0.014437 -0.015770 -0.006963 -0.002578 0.015778 -0.006955 -0.002580 
=================================
In update_step_nve() part-2, (body->atoms[i]).atom_vel    -0.0000000465     0.0000778794     0.0004398791
In update_step_nve() part-2, (body->atoms[i]).atom_vel    -0.0002887688    -0.0005425285     0.0006810484
In update_step_nve() part-2, (body->atoms[i]).atom_vel     0.0002882661    -0.0005430597     0.0006812484
    STATE AFTER 3 STEPS

    GEOMETRY (ANGSTROMS)

A01O1               -0.000002     0.067167     0.030866
A02H2               -0.779199    -0.530563     0.038804
A03H3                0.779183    -0.530580     0.038811
A01N1                0.000007    -0.000539     2.937945
A02H2               -0.466804    -0.807620     3.296921
A03H3               -0.466816     0.809379     3.290459
A04H4                0.933564     0.000890     3.293789


    RESTART DATA

fragment H2O_L
   0.000000e+00   0.000000e+00   0.000000e+00   3.141593e+00   1.570796e+00   0.000000e+00
velocity
   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00

fragment NH3_L
   2.388910e-06  -2.865545e-04   3.001122e+00  -3.123839e+00   3.997324e-03   3.123846e+00
velocity
   7.347100e-08  -8.903180e-06   3.503337e-05  -6.577726e-05  -1.159964e-06   1.253640e-07


Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0000865434
Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0000865434
Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0000865434
    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0033203325
           POLARIZATION ENERGY    -0.0008793263
             DISPERSION ENERGY    -0.0026212704
     EXCHANGE REPULSION ENERGY     0.0074997817
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY     0.0000000000
                     LJ ENERGY     0.0000000000

                     ML ENERGY   -76.3879051007

                  TOTAL ENERGY   -76.3805855833


                KINETIC ENERGY     0.0044991053
                     INVARIANT   -76.3760864780
               TEMPERATURE (K)   189.4273523854


 time_step =    41.3413733366
Doing update_step_nve, Using Enable-Torch
body->mass 31037.4928179414
Full position update.. will update special fragment
special_atom-mass    15.9949100000
In update_step_nve() part-1, (body->atoms[i]).atom_vel    -0.0000000541     0.0000696757     0.0004296439
special_atom-mass     1.0078250000
In update_step_nve() part-1, (body->atoms[i]).atom_vel    -0.0001113342    -0.0004641816     0.0007100570
special_atom-mass     1.0078250000
In update_step_nve() part-1, (body->atoms[i]).atom_vel     0.0001107405    -0.0004648041     0.0007102724
Updating fragment using update_special_fragment routine()
Inside compute forces, Torch enabled
Setting special fragments as Torch coordinates
tG_double Gradients:
    0.0000001479	    0.0251806863	   -0.0005817248	
   -0.0213408812	   -0.0125897931	    0.0002906908	
    0.0213407333	   -0.0125908932	    0.0002910340	

Torch gradient in energy.c
0.000000 0.025181 -0.000582 -0.021341 -0.012590 0.000291 0.021341 -0.012591 0.000291 
EFP fragment atomic gradient
0.000010 -0.002021 0.014956 0.000004 -0.000216 -0.002695 0.000004 -0.000207 -0.002694 

====Torch grad + EFP grad ===
0.000011 0.023160 0.014375 -0.021337 -0.012805 -0.002404 0.021345 -0.012798 -0.002403 
=================================
In update_step_nve() part-2, (body->atoms[i]).atom_vel    -0.0000000615     0.0000532565     0.0004194531
In update_step_nve() part-2, (body->atoms[i]).atom_vel     0.0001287373    -0.0003201019     0.0007371089
In update_step_nve() part-2, (body->atoms[i]).atom_vel    -0.0001294194    -0.0003208079     0.0007373144
    STATE AFTER 4 STEPS

    GEOMETRY (ANGSTROMS)

A01O1               -0.000003     0.068691     0.040265
A02H2               -0.781635    -0.540718     0.054338
A03H3                0.781606    -0.540748     0.054350
A01N1                0.000012    -0.000970     2.938848
A02H2               -0.466814    -0.806902     3.300377
A03H3               -0.466835     0.810068     3.288743
A04H4                0.933549     0.001603     3.294738


    RESTART DATA

fragment H2O_L
   0.000000e+00   0.000000e+00   0.000000e+00   3.141593e+00   1.570796e+00   0.000000e+00
velocity
   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00

fragment NH3_L
   4.268841e-06  -5.155210e-04   3.002024e+00  -3.123913e+00   7.196029e-03   3.123927e+00
velocity
   9.818856e-08  -1.209337e-05   4.758477e-05  -8.943362e-05  -1.561626e-06   1.722078e-07


Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0001598352
Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0001598352
Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0001598352
    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0032759150
           POLARIZATION ENERGY    -0.0008944186
             DISPERSION ENERGY    -0.0026711271
     EXCHANGE REPULSION ENERGY     0.0077263987
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY     0.0000000000
                     LJ ENERGY     0.0000000000

                     ML ENERGY   -76.3873005755

                  TOTAL ENERGY   -76.3798638076


                KINETIC ENERGY     0.0039039422
                     INVARIANT   -76.3759598654
               TEMPERATURE (K)   164.3689982486


 time_step =    41.3413733366
Doing update_step_nve, Using Enable-Torch
body->mass 31037.4928179414
Full position update.. will update special fragment
special_atom-mass    15.9949100000
In update_step_nve() part-1, (body->atoms[i]).atom_vel    -0.0000000690     0.0000368373     0.0004092623
special_atom-mass     1.0078250000
In update_step_nve() part-1, (body->atoms[i]).atom_vel     0.0003688089    -0.0001760222     0.0007641609
special_atom-mass     1.0078250000
In update_step_nve() part-1, (body->atoms[i]).atom_vel    -0.0003695792    -0.0001768117     0.0007643563
Updating fragment using update_special_fragment routine()
Inside compute forces, Torch enabled
Setting special fragments as Torch coordinates
tG_double Gradients:
    0.0000000710	    0.0245940041	   -0.0008748885	
   -0.0170619505	   -0.0122962076	    0.0004372514	
    0.0170618795	   -0.0122977975	    0.0004376371	

Torch gradient in energy.c
0.000000 0.024594 -0.000875 -0.017062 -0.012296 0.000437 0.017062 -0.012298 0.000438 
EFP fragment atomic gradient
0.000010 -0.002021 0.015318 0.000004 -0.000264 -0.002769 0.000004 -0.000256 -0.002765 

====Torch grad + EFP grad ===
0.000010 0.022573 0.014443 -0.017058 -0.012560 -0.002332 0.017066 -0.012554 -0.002327 
=================================
In update_step_nve() part-2, (body->atoms[i]).atom_vel    -0.0000000763     0.0000208345     0.0003990228
In update_step_nve() part-2, (body->atoms[i]).atom_vel     0.0005607400    -0.0000347019     0.0007903953
In update_step_nve() part-2, (body->atoms[i]).atom_vel    -0.0005615917    -0.0000355594     0.0007905421
    STATE AFTER 5 STEPS

    GEOMETRY (ANGSTROMS)

A01O1               -0.000004     0.069497     0.049218
A02H2               -0.773566    -0.544569     0.071055
A03H3                0.773520    -0.544617     0.071072
A01N1                0.000019    -0.001535     2.940031
A02H2               -0.466827    -0.805947     3.304905
A03H3               -0.466860     0.810960     3.286485
A04H4                0.933531     0.002539     3.295975


    RESTART DATA

fragment H2O_L
   0.000000e+00   0.000000e+00   0.000000e+00   3.141593e+00   1.570796e+00   0.000000e+00
velocity
   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00

fragment NH3_L
   6.685035e-06  -8.156857e-04   3.003204e+00  -3.124020e+00   1.139307e-02   3.124042e+00
velocity
   1.220887e-07  -1.541330e-05   6.047255e-05  -1.140424e-04  -1.964284e-06   2.167703e-07


Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0002591161
Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0002591161
Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0002591161
    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0031035327
           POLARIZATION ENERGY    -0.0008954328
             DISPERSION ENERGY    -0.0027187296
     EXCHANGE REPULSION ENERGY     0.0079456414
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY     0.0000000000
                     LJ ENERGY     0.0000000000

                     ML ENERGY   -76.3876573661

                  TOTAL ENERGY   -76.3802223543


                KINETIC ENERGY     0.0041857862
                     INVARIANT   -76.3760365681
               TEMPERATURE (K)   176.2355730020


 time_step =    41.3413733366
Doing update_step_nve, Using Enable-Torch
body->mass 31037.4928179414
Full position update.. will update special fragment
special_atom-mass    15.9949100000
In update_step_nve() part-1, (body->atoms[i]).atom_vel    -0.0000000836     0.0000048317     0.0003887832
special_atom-mass     1.0078250000
In update_step_nve() part-1, (body->atoms[i]).atom_vel     0.0007526711     0.0001066184     0.0008166296
special_atom-mass     1.0078250000
In update_step_nve() part-1, (body->atoms[i]).atom_vel    -0.0007536042     0.0001056929     0.0008167280
Updating fragment using update_special_fragment routine()
Inside compute forces, Torch enabled
Setting special fragments as Torch coordinates
tG_double Gradients:
   -0.0000005342	    0.0123231104	   -0.0006284922	
   -0.0039088946	   -0.0061609441	    0.0003141754	
    0.0039094289	   -0.0061621658	    0.0003143168	

Torch gradient in energy.c
-0.000001 0.012323 -0.000628 -0.003909 -0.006161 0.000314 0.003909 -0.006162 0.000314 
EFP fragment atomic gradient
0.000010 -0.001993 0.015700 0.000003 -0.000326 -0.002888 0.000003 -0.000320 -0.002879 

====Torch grad + EFP grad ===
0.000010 0.010330 0.015072 -0.003906 -0.006487 -0.002574 0.003912 -0.006482 -0.002565 
=================================
In update_step_nve() part-2, (body->atoms[i]).atom_vel    -0.0000000904    -0.0000024914     0.0003780982
In update_step_nve() part-2, (body->atoms[i]).atom_vel     0.0007966187     0.0001796080     0.0008455882
In update_step_nve() part-2, (body->atoms[i]).atom_vel    -0.0007976243     0.0001786277     0.0008455847
    STATE AFTER 6 STEPS

    GEOMETRY (ANGSTROMS)

A01O1               -0.000006     0.069603     0.057724
A02H2               -0.757100    -0.542236     0.088920
A03H3                0.757034    -0.542304     0.088939
A01N1                0.000028    -0.002240     2.941501
A02H2               -0.466843    -0.804736     3.310538
A03H3               -0.466890     0.812053     3.283657
A04H4                0.933507     0.003706     3.297503


    RESTART DATA

fragment H2O_L
   0.000000e+00   0.000000e+00   0.000000e+00   3.141593e+00   1.570796e+00   0.000000e+00
velocity
   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00

fragment NH3_L
   9.610691e-06  -1.189912e-03   3.004670e+00  -3.124159e+00   1.662677e-02   3.124191e+00
velocity
   1.443994e-07  -1.886401e-05   7.360428e-05  -1.395446e-04  -2.363258e-06   2.544189e-07


Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0003861711
Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0003861711
Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0003861711
    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0028117589
           POLARIZATION ENERGY    -0.0008832793
             DISPERSION ENERGY    -0.0027638302
     EXCHANGE REPULSION ENERGY     0.0081560383
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY     0.0000000000
                     LJ ENERGY     0.0000000000

                     ML ENERGY   -76.3883781213

                  TOTAL ENERGY   -76.3810574336


                KINETIC ENERGY     0.0048171575
                     INVARIANT   -76.3762402760
               TEMPERATURE (K)   202.8184137829


 time_step =    41.3413733366
Doing update_step_nve, Using Enable-Torch
body->mass 31037.4928179414
Full position update.. will update special fragment
special_atom-mass    15.9949100000
In update_step_nve() part-1, (body->atoms[i]).atom_vel    -0.0000000971    -0.0000098146     0.0003674133
special_atom-mass     1.0078250000
In update_step_nve() part-1, (body->atoms[i]).atom_vel     0.0008405664     0.0002525975     0.0008745468
special_atom-mass     1.0078250000
In update_step_nve() part-1, (body->atoms[i]).atom_vel    -0.0008416444     0.0002515626     0.0008744414
Updating fragment using update_special_fragment routine()
Inside compute forces, Torch enabled
Setting special fragments as Torch coordinates
tG_double Gradients:
   -0.0000017986	   -0.0055761701	    0.0003891316	
    0.0125400543	    0.0027879126	   -0.0001944679	
   -0.0125382555	    0.0027882576	   -0.0001946637	

Torch gradient in energy.c
-0.000002 -0.005576 0.000389 0.012540 0.002788 -0.000194 -0.012538 0.002788 -0.000195 
EFP fragment atomic gradient
0.000011 -0.001933 0.016086 0.000002 -0.000406 -0.003033 0.000002 -0.000401 -0.003018 

====Torch grad + EFP grad ===
0.000009 -0.007509 0.016475 0.012542 0.002382 -0.003227 -0.012536 0.002387 -0.003212 
=================================
In update_step_nve() part-2, (body->atoms[i]).atom_vel    -0.0000001033    -0.0000044912     0.0003557331
In update_step_nve() part-2, (body->atoms[i]).atom_vel     0.0006994496     0.0002257945     0.0009108552
In update_step_nve() part-2, (body->atoms[i]).atom_vel    -0.0007005930     0.0002247079     0.0009105846
    STATE AFTER 7 STEPS

    GEOMETRY (ANGSTROMS)

A01O1               -0.000008     0.069388     0.065762
A02H2               -0.738711    -0.536710     0.108053
A03H3                0.738621    -0.536801     0.108069
A01N1                0.000038    -0.003090     2.943264
A02H2               -0.466863    -0.803248     3.317303
A03H3               -0.466925     0.813339     3.280230
A04H4                0.933480     0.005112     3.299320


    RESTART DATA

fragment H2O_L
   0.000000e+00   0.000000e+00   0.000000e+00   3.141593e+00   1.570796e+00   0.000000e+00
velocity
   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00

fragment NH3_L
   1.300306e-05  -1.641058e-03   3.006425e+00  -3.124325e+00   2.293265e-02   3.124368e+00
velocity
   1.647420e-07  -2.244680e-05   8.690359e-05  -1.659022e-04  -2.758679e-06   2.819826e-07


Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0005425892
Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0005425892
Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0005425892
    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0024500153
           POLARIZATION ENERGY    -0.0008634573
             DISPERSION ENERGY    -0.0028062173
     EXCHANGE REPULSION ENERGY     0.0083562585
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY     0.0000000000
                     LJ ENERGY     0.0000000000

                     ML ENERGY   -76.3881085230

                  TOTAL ENERGY   -76.3809719237


                KINETIC ENERGY     0.0046336651
                     INVARIANT   -76.3763382586
               TEMPERATURE (K)   195.0927707218


 time_step =    41.3413733366
Doing update_step_nve, Using Enable-Torch
body->mass 31037.4928179414
Full position update.. will update special fragment
special_atom-mass    15.9949100000
In update_step_nve() part-1, (body->atoms[i]).atom_vel    -0.0000001095     0.0000008322     0.0003440530
special_atom-mass     1.0078250000
In update_step_nve() part-1, (body->atoms[i]).atom_vel     0.0005583329     0.0001989915     0.0009471635
special_atom-mass     1.0078250000
In update_step_nve() part-1, (body->atoms[i]).atom_vel    -0.0005595416     0.0001978533     0.0009467277
Updating fragment using update_special_fragment routine()
Inside compute forces, Torch enabled
Setting special fragments as Torch coordinates
tG_double Gradients:
   -0.0000024563	   -0.0192327513	    0.0017732953	
    0.0242327602	    0.0096148331	   -0.0008865679	
   -0.0242303039	    0.0096179182	   -0.0008867274	

Torch gradient in energy.c
-0.000002 -0.019233 0.001773 0.024233 0.009615 -0.000887 -0.024230 0.009618 -0.000887 
EFP fragment atomic gradient
0.000012 -0.001842 0.016453 0.000001 -0.000505 -0.003173 0.000001 -0.000502 -0.003153 

====Torch grad + EFP grad ===
0.000009 -0.021075 0.018226 0.024234 0.009110 -0.004059 -0.024229 0.009116 -0.004040 
=================================
In update_step_nve() part-2, (body->atoms[i]).atom_vel    -0.0000001162     0.0000157732     0.0003311318
In update_step_nve() part-2, (body->atoms[i]).atom_vel     0.0002856664     0.0000964878     0.0009928358
In update_step_nve() part-2, (body->atoms[i]).atom_vel    -0.0002869269     0.0000952852     0.0009921791
    STATE AFTER 8 STEPS

    GEOMETRY (ANGSTROMS)

A01O1               -0.000011     0.069406     0.073288
A02H2               -0.726496    -0.532357     0.128774
A03H3                0.726380    -0.532472     0.128781
A01N1                0.000050    -0.004089     2.945324
A02H2               -0.466888    -0.801459     3.325227
A03H3               -0.466964     0.814809     3.276172
A04H4                0.933447     0.006763     3.301423


    RESTART DATA

fragment H2O_L
   0.000000e+00   0.000000e+00   0.000000e+00   3.141593e+00   1.570796e+00   0.000000e+00
velocity
   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00

fragment NH3_L
   1.681878e-05  -2.172045e-03   3.008472e+00  -3.124504e+00   3.034591e-02   3.124559e+00
velocity
   1.837507e-07  -2.616884e-05   1.003321e-04  -1.931679e-04  -3.159947e-06   2.989097e-07


Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0007303007
Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0007303007
Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0007303007
    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0020833153
           POLARIZATION ENERGY    -0.0008427634
             DISPERSION ENERGY    -0.0028457392
     EXCHANGE REPULSION ENERGY     0.0085451847
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY     0.0000000000
                     LJ ENERGY     0.0000000000

                     ML ENERGY   -76.3871893365

                  TOTAL ENERGY   -76.3802493391


                KINETIC ENERGY     0.0039444833
                     INVARIANT   -76.3763048558
               TEMPERATURE (K)   166.0759165199


 time_step =    41.3413733366
Doing update_step_nve, Using Enable-Torch
body->mass 31037.4928179414
Full position update.. will update special fragment
special_atom-mass    15.9949100000
In update_step_nve() part-1, (body->atoms[i]).atom_vel    -0.0000001229     0.0000307143     0.0003182105
special_atom-mass     1.0078250000
In update_step_nve() part-1, (body->atoms[i]).atom_vel     0.0000129999    -0.0000060160     0.0010385082
special_atom-mass     1.0078250000
In update_step_nve() part-1, (body->atoms[i]).atom_vel    -0.0000143121    -0.0000072828     0.0010376304
Updating fragment using update_special_fragment routine()
Inside compute forces, Torch enabled
Setting special fragments as Torch coordinates
tG_double Gradients:
   -0.0000011483	   -0.0166974480	    0.0019737894	
    0.0233366310	    0.0083462145	   -0.0009870676	
   -0.0233354817	    0.0083512345	   -0.0009867218	

Torch gradient in energy.c
-0.000001 -0.016697 0.001974 0.023337 0.008346 -0.000987 -0.023335 0.008351 -0.000987 
EFP fragment atomic gradient
0.000015 -0.001732 0.016776 0.000000 -0.000622 -0.003282 0.000000 -0.000620 -0.003261 

====Torch grad + EFP grad ===
0.000014 -0.018429 0.018750 0.023337 0.007725 -0.004269 -0.023335 0.007731 -0.004248 
=================================
In update_step_nve() part-2, (body->atoms[i]).atom_vel    -0.0000001325     0.0000437796     0.0003049176
In update_step_nve() part-2, (body->atoms[i]).atom_vel    -0.0002495768    -0.0000929298     0.0010865401
In update_step_nve() part-2, (body->atoms[i]).atom_vel     0.0002482415    -0.0000942705     0.0010854221
    STATE AFTER 9 STEPS

    GEOMETRY (ANGSTROMS)

A01O1               -0.000013     0.070078     0.080250
A02H2               -0.726212    -0.532488     0.151493
A03H3                0.726067    -0.532632     0.151481
A01N1                0.000063    -0.005243     2.947685
A02H2               -0.466919    -0.799338     3.334334
A03H3               -0.467007     0.816451     3.271447
A04H4                0.933411     0.008668     3.303808


    RESTART DATA

fragment H2O_L
   0.000000e+00   0.000000e+00   0.000000e+00   3.141593e+00   1.570796e+00   0.000000e+00
velocity
   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00

fragment NH3_L
   2.104286e-05  -2.786045e-03   3.010815e+00  -3.124676e+00   3.890644e-02   3.124743e+00
velocity
   2.034661e-07  -3.004640e-05   1.138923e-04  -2.215142e-04  -3.587841e-06   3.069405e-07


Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0009521644
Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0009521644
Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0009521644
    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0017581147
           POLARIZATION ENERGY    -0.0008257151
             DISPERSION ENERGY    -0.0028823124
     EXCHANGE REPULSION ENERGY     0.0087218991
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY     0.0000000000
                     LJ ENERGY     0.0000000000

                     ML ENERGY   -76.3872464573

                  TOTAL ENERGY   -76.3804744710


                KINETIC ENERGY     0.0041560282
                     INVARIANT   -76.3763184428
               TEMPERATURE (K)   174.9826601676


 time_step =    41.3413733366
Doing update_step_nve, Using Enable-Torch
body->mass 31037.4928179414
Full position update.. will update special fragment
special_atom-mass    15.9949100000
In update_step_nve() part-1, (body->atoms[i]).atom_vel    -0.0000001421     0.0000568450     0.0002916247
special_atom-mass     1.0078250000
In update_step_nve() part-1, (body->atoms[i]).atom_vel    -0.0005121535    -0.0001798436     0.0011345719
special_atom-mass     1.0078250000
In update_step_nve() part-1, (body->atoms[i]).atom_vel     0.0005107951    -0.0001812583     0.0011332137
Updating fragment using update_special_fragment routine()
Inside compute forces, Torch enabled
Setting special fragments as Torch coordinates
tG_double Gradients:
    0.0000022025	    0.0001704099	   -0.0000251378	
    0.0110606099	   -0.0000874130	    0.0000123868	
   -0.0110628119	   -0.0000829969	    0.0000127511	

Torch gradient in energy.c
0.000002 0.000170 -0.000025 0.011061 -0.000087 0.000012 -0.011063 -0.000083 0.000013 
EFP fragment atomic gradient
0.000019 -0.001605 0.017046 0.000000 -0.000754 -0.003354 0.000000 -0.000753 -0.003337 

====Torch grad + EFP grad ===
0.000022 -0.001435 0.017021 0.011061 -0.000841 -0.003342 -0.011062 -0.000836 -0.003325 
=================================
In update_step_nve() part-2, (body->atoms[i]).atom_vel    -0.0000001573     0.0000578621     0.0002795578
In update_step_nve() part-2, (body->atoms[i]).atom_vel    -0.0006366056    -0.0001703813     0.0011721738
In update_step_nve() part-2, (body->atoms[i]).atom_vel     0.0006352643    -0.0001718556     0.0011706199
    STATE AFTER 10 STEPS

    GEOMETRY (ANGSTROMS)

A01O1               -0.000016     0.071322     0.086630
A02H2               -0.737416    -0.536423     0.176314
A03H3                0.737242    -0.536597     0.176272
A01N1                0.000077    -0.006559     2.950353
A02H2               -0.466956    -0.796851     3.344657
A03H3               -0.467053     0.818248     3.266009
A04H4                0.933369     0.010838     3.306470


    RESTART DATA

fragment H2O_L
   0.000000e+00   0.000000e+00   0.000000e+00   3.141593e+00   1.570796e+00   0.000000e+00
velocity
   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00

fragment NH3_L
   2.572120e-05  -3.486690e-03   3.013455e+00  -3.124815e+00   4.866371e-02   3.124895e+00
velocity
   2.271616e-07  -3.409876e-05   1.276039e-04  -2.511652e-04  -4.072655e-06   3.084144e-07


Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0012119736
Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0012119736
Inside get_kinetic_energy(), Torch enabled
regular ke =     0.0012119736
    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0014708624
           POLARIZATION ENERGY    -0.0008118193
             DISPERSION ENERGY    -0.0029158946
     EXCHANGE REPULSION ENERGY     0.0088855505
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY     0.0000000000
                     LJ ENERGY     0.0000000000

                     ML ENERGY   -76.3880834760

                  TOTAL ENERGY   -76.3814547769


                KINETIC ENERGY     0.0051117938
                     INVARIANT   -76.3763429831
               TEMPERATURE (K)   215.2235835950


MOLECULAR DYNAMICS JOB COMPLETED SUCCESSFULLY
WALL CLOCK TIME IS Mon Apr 14 12:59:37 2025
TOTAL RUN TIME IS 41 SECONDS
