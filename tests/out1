EFPMD ver. 1.8.0
Copyright (c) 2012-2017 Ilya Kaliman

LIBEFP ver. 1.8.0
Copyright (c) 2012-2017 Ilya Kaliman
              2018-2022 Lyudmila Slipchenko

Journal References:
  - Kaliman and Slipchenko, JCC 2013.
    DOI: http://dx.doi.org/10.1002/jcc.23375
  - Kaliman and Slipchenko, JCC 2015.
    DOI: http://dx.doi.org/10.1002/jcc.23772

Project web site: https://github.com/libefp2/libefp/

RUNNING 1 MPI PROCESSES WITH 1 OPENMP THREADS EACH
WALL CLOCK TIME IS Mon Jul 15 04:02:32 2024

SIMULATION SETTINGS

run_type opt
coord xyzabc
terms elec pol disp xr
special_terms elec pol disp xr
elec_damp screen
disp_damp off
pol_damp tt
pol_driver iterative
enable_ff false
enable_multistep false
ff_geometry ff.xyz
ff_parameters /../fraglib/params/amber99.prm
single_params_file false
efp_params_file params.efp
enable_cutoff false
swf_cutoff 10
xr_cutoff 0
max_steps 100
multistep_steps 1
fraglib_path ../fraglib
userlib_path .
enable_pbc false
periodic_box 30.0 30.0 30.0 90.0 90.0 90.0
opt_tol 0.0001
gtest_tol 1e-06
ref_energy 0
hess_central false
num_step_dist 0.001
num_step_angle 0.01
ensemble nve
time_step 1
print_step 1
velocitize false
temperature 300
pressure 1
thermostat_tau 1000
barostat_tau 10000
ligand -100
enable_pairwise false
print_pbc false
symmetry false
special_fragment 0
enable_torch true
opt_special_frag 0
torch_nn ani.pt
symm_frag frag
update_params 0
update_params_cutoff 0
print 0


marker for coming inside state_init

xr_cutoff is set to 10.000000 

marker for coming inside torch_set_coord
SPECIAL FRAGMENT ENERGY MINIMIZATION JOB


marker call for entry in compute_efp
We are running case-0
We just updated the special fragment
marker for coming inside torch_set_coord
We are setting the new coordinates from updated fragment
SINGLE FRAGMENT TORCH JOB
-------------------------

Special fragment Atomic Energies:
--------------------------------
   0		  -75.196503
   0		   -0.595260
   0		   -0.595260
--------------------------------

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   0          0.000000          0.063030         0.000000
   0         -0.752652         -0.500166         0.000000
   0          0.752652         -0.500166         0.000000
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.000000         -0.074893         0.000000
   2          0.038270          0.037446         0.000000
   3         -0.038270          0.037446         0.000000
------------------------------------------------------------

 Torch energy -76.387024 

Finished running 'compute_energy()' which traverses through torch routines
    INITIAL STATE

    GEOMETRY (ANGSTROMS)

A01O1                0.000000     0.063030     0.000000
A02H2               -0.752652    -0.500166     0.000000
A03H3                0.752652    -0.500166     0.000000
A01O1                5.047701    -0.041199     0.000000
A02H2                5.113439     0.896539     0.000000
A03H3                4.129507    -0.242679     0.000000
A01N1                0.000000     5.000000    -0.063177
A02H2                0.929426     4.912005     0.292603
A03H3               -0.540919     4.239091     0.292603
A04H4               -0.388507     5.848904     0.292603


    RESTART DATA

fragment H2O_L
   0.000000e+00   1.794358e-11   0.000000e+00   1.110223e-16   0.000000e+00   0.000000e+00

fragment H2O_L
   5.000000e+00   0.000000e+00   0.000000e+00  -2.283185e+00   0.000000e+00   0.000000e+00

fragment NH3_L
   0.000000e+00   5.000000e+00   0.000000e+00   2.000000e+00   0.000000e+00   0.000000e+00


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0001397059
           POLARIZATION ENERGY    -0.0000429508
             DISPERSION ENERGY    -0.0001897219
     EXCHANGE REPULSION ENERGY     0.0000079576
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000

                  TOTAL ENERGY   -76.3871089350


                 ENERGY CHANGE     0.0000000000
                  RMS GRADIENT     0.0355005413
              MAXIMUM GRADIENT     0.0748926401


We should be entering the loop of optimization
Inside the optimization loop... this is step    1
marker call for entry in compute_efp
We are running case-0
We just updated the special fragment
marker for coming inside torch_set_coord
We are setting the new coordinates from updated fragment
SINGLE FRAGMENT TORCH JOB
-------------------------

Special fragment Atomic Energies:
--------------------------------
   0		  -75.162094
   0		   -0.525066
   0		   -0.525066
--------------------------------

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   0          0.000000          0.435151         0.000000
   0         -0.942807         -0.686226         0.000000
   0          0.942807         -0.686226         0.000000
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.000000          0.312367         0.000000
   2         -0.132369         -0.156184         0.000000
   3          0.132369         -0.156184         0.000000
------------------------------------------------------------

 Torch energy -76.212234 

Finished running 'compute_energy()' which traverses through torch routines
marker call for entry in compute_efp
We are running case-0
We just updated the special fragment
marker for coming inside torch_set_coord
We are setting the new coordinates from updated fragment
SINGLE FRAGMENT TORCH JOB
-------------------------

Special fragment Atomic Energies:
--------------------------------
   0		  -75.195068
   0		   -0.593535
   0		   -0.593535
--------------------------------

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   0          0.000000          0.128441         0.000000
   0         -0.786077         -0.532871         0.000000
   0          0.786077         -0.532871         0.000000
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1         -0.000000          0.133709         0.000000
   2         -0.069866         -0.066854         0.000000
   3          0.069866         -0.066854         0.000000
------------------------------------------------------------

 Torch energy -76.382141 

Finished running 'compute_energy()' which traverses through torch routines
marker call for entry in compute_efp
We are running case-0
We just updated the special fragment
marker for coming inside torch_set_coord
We are setting the new coordinates from updated fragment
SINGLE FRAGMENT TORCH JOB
-------------------------

Special fragment Atomic Energies:
--------------------------------
   0		  -75.196396
   0		   -0.595975
   0		   -0.595975
--------------------------------

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   0          0.000000          0.090211         0.000000
   0         -0.766541         -0.513756         0.000000
   0          0.766541         -0.513756         0.000000
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.000000          0.020211         0.000000
   2         -0.015983         -0.010105         0.000000
   3          0.015983         -0.010105         0.000000
------------------------------------------------------------

 Torch energy -76.388351 

Finished running 'compute_energy()' which traverses through torch routines
    STATE AFTER 1 STEPS

    GEOMETRY (ANGSTROMS)

A01O1                0.000000     0.090211     0.000000
A02H2               -0.766541    -0.513756     0.000000
A03H3                0.766541    -0.513756     0.000000
A01O1                5.047701    -0.041199     0.000000
A02H2                5.113439     0.896539     0.000000
A03H3                4.129507    -0.242679     0.000000
A01N1                0.000000     5.000000    -0.063177
A02H2                0.929426     4.912005     0.292603
A03H3               -0.540919     4.239091     0.292603
A04H4               -0.388507     5.848904     0.292603


    RESTART DATA

fragment H2O_L
   0.000000e+00   2.261806e-02   0.000000e+00   2.492607e-02   0.000000e+00   0.000000e+00

fragment H2O_L
   5.000000e+00   0.000000e+00   0.000000e+00  -2.283185e+00   0.000000e+00   0.000000e+00

fragment NH3_L
   0.000000e+00   5.000000e+00   0.000000e+00   2.000000e+00   0.000000e+00   0.000000e+00


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0001036737
           POLARIZATION ENERGY    -0.0000472526
             DISPERSION ENERGY    -0.0001927340
     EXCHANGE REPULSION ENERGY     0.0000086355
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000

                  TOTAL ENERGY   -76.3884791178


                 ENERGY CHANGE    -0.0013701828
                  RMS GRADIENT     0.0111733743
              MAXIMUM GRADIENT     0.0202107504


Inside the optimization loop... this is step    2
marker call for entry in compute_efp
We are running case-0
We just updated the special fragment
marker for coming inside torch_set_coord
We are setting the new coordinates from updated fragment
SINGLE FRAGMENT TORCH JOB
-------------------------

Special fragment Atomic Energies:
--------------------------------
   0		  -75.196518
   0		   -0.596002
   0		   -0.596002
--------------------------------

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   0          0.000000          0.084466         0.000000
   0         -0.762409         -0.510884         0.000000
   0          0.762409         -0.510884         0.000000
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.000000         -0.000100         0.000000
   2         -0.003931          0.000050         0.000000
   3          0.003931          0.000050         0.000000
------------------------------------------------------------

 Torch energy -76.388519 

Finished running 'compute_energy()' which traverses through torch routines
    STATE AFTER 2 STEPS

    GEOMETRY (ANGSTROMS)

A01O1                0.000000     0.084466     0.000000
A02H2               -0.762409    -0.510884     0.000000
A03H3                0.762409    -0.510884     0.000000
A01O1                5.047701    -0.041199     0.000000
A02H2                5.113439     0.896539     0.000000
A03H3                4.129507    -0.242679     0.000000
A01N1                0.000000     5.000000    -0.063177
A02H2                0.929426     4.912005     0.292603
A03H3               -0.540919     4.239091     0.292603
A04H4               -0.388507     5.848904     0.292603


    RESTART DATA

fragment H2O_L
   0.000000e+00   1.783720e-02   0.000000e+00   2.057205e-02   0.000000e+00   0.000000e+00

fragment H2O_L
   5.000000e+00   0.000000e+00   0.000000e+00  -2.283185e+00   0.000000e+00   0.000000e+00

fragment NH3_L
   0.000000e+00   5.000000e+00   0.000000e+00   2.000000e+00   0.000000e+00   0.000000e+00


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0001091014
           POLARIZATION ENERGY    -0.0000462791
             DISPERSION ENERGY    -0.0001920940
     EXCHANGE REPULSION ENERGY     0.0000084987
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000

                  TOTAL ENERGY   -76.3886400601


                 ENERGY CHANGE    -0.0001609423
                  RMS GRADIENT     0.0018534012
              MAXIMUM GRADIENT     0.0039307065


Inside the optimization loop... this is step    3
marker call for entry in compute_efp
We are running case-0
We just updated the special fragment
marker for coming inside torch_set_coord
We are setting the new coordinates from updated fragment
SINGLE FRAGMENT TORCH JOB
-------------------------

Special fragment Atomic Energies:
--------------------------------
   0		  -75.196556
   0		   -0.595986
   0		   -0.595986
--------------------------------

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   0         -0.000000          0.084467         0.000000
   0         -0.761095         -0.510885         0.000000
   0          0.761095         -0.510885         0.000000
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.000000         -0.001984         0.000000
   2         -0.001857          0.000992         0.000000
   3          0.001857          0.000992         0.000000
------------------------------------------------------------

 Torch energy -76.388527 

Finished running 'compute_energy()' which traverses through torch routines
    STATE AFTER 3 STEPS

    GEOMETRY (ANGSTROMS)

A01O1               -0.000000     0.084467     0.000000
A02H2               -0.761095    -0.510885     0.000000
A03H3                0.761095    -0.510885     0.000000
A01O1                5.047701    -0.041199     0.000000
A02H2                5.113439     0.896539     0.000000
A03H3                4.129507    -0.242679     0.000000
A01N1                0.000000     5.000000    -0.063177
A02H2                0.929426     4.912005     0.292603
A03H3               -0.540919     4.239091     0.292603
A04H4               -0.388507     5.848904     0.292603


    RESTART DATA

fragment H2O_L
  -1.044143e-09   1.783864e-02   0.000000e+00   2.141127e-02   0.000000e+00   0.000000e+00

fragment H2O_L
   5.000000e+00   0.000000e+00   0.000000e+00  -2.283185e+00   0.000000e+00   0.000000e+00

fragment NH3_L
   0.000000e+00   5.000000e+00   0.000000e+00   2.000000e+00   0.000000e+00   0.000000e+00


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0001067171
           POLARIZATION ENERGY    -0.0000462405
             DISPERSION ENERGY    -0.0001920976
     EXCHANGE REPULSION ENERGY     0.0000085079
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000

                  TOTAL ENERGY   -76.3886500296


                 ENERGY CHANGE    -0.0000099695
                  RMS GRADIENT     0.0011926954
              MAXIMUM GRADIENT     0.0019836742


Inside the optimization loop... this is step    4
marker call for entry in compute_efp
We are running case-0
We just updated the special fragment
marker for coming inside torch_set_coord
We are setting the new coordinates from updated fragment
SINGLE FRAGMENT TORCH JOB
-------------------------

Special fragment Atomic Energies:
--------------------------------
   0		  -75.196609
   0		   -0.595959
   0		   -0.595959
--------------------------------

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   0         -0.000000          0.085599         0.000000
   0         -0.759145         -0.511450         0.000000
   0          0.759145         -0.511451         0.000000
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.000000         -0.001746         0.000000
   2         -0.000054          0.000873         0.000000
   3          0.000054          0.000873         0.000000
------------------------------------------------------------

 Torch energy -76.388535 

Finished running 'compute_energy()' which traverses through torch routines
    STATE AFTER 4 STEPS

    GEOMETRY (ANGSTROMS)

A01O1               -0.000000     0.085599     0.000000
A02H2               -0.759145    -0.511450     0.000000
A03H3                0.759145    -0.511451     0.000000
A01O1                5.047701    -0.041199     0.000000
A02H2                5.113439     0.896539     0.000000
A03H3                4.129507    -0.242679     0.000000
A01N1                0.000000     5.000000    -0.063177
A02H2                0.929426     4.912005     0.292603
A03H3               -0.540919     4.239091     0.292603
A04H4               -0.388507     5.848904     0.292603


    RESTART DATA

fragment H2O_L
  -3.576676e-09   1.878035e-02   0.000000e+00   2.403960e-02   0.000000e+00   0.000000e+00

fragment H2O_L
   5.000000e+00   0.000000e+00   0.000000e+00  -2.283185e+00   0.000000e+00   0.000000e+00

fragment NH3_L
   0.000000e+00   5.000000e+00   0.000000e+00   2.000000e+00   0.000000e+00   0.000000e+00


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0001006477
           POLARIZATION ENERGY    -0.0000463494
             DISPERSION ENERGY    -0.0001922304
     EXCHANGE REPULSION ENERGY     0.0000085540
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000

                  TOTAL ENERGY   -76.3886639239


                 ENERGY CHANGE    -0.0000138943
                  RMS GRADIENT     0.0007131921
              MAXIMUM GRADIENT     0.0017458275


Inside the optimization loop... this is step    5
marker call for entry in compute_efp
We are running case-0
We just updated the special fragment
marker for coming inside torch_set_coord
We are setting the new coordinates from updated fragment
SINGLE FRAGMENT TORCH JOB
-------------------------

Special fragment Atomic Energies:
--------------------------------
   0		  -75.196640
   0		   -0.595948
   0		   -0.595948
--------------------------------

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   0         -0.000000          0.086639         0.000000
   0         -0.758367         -0.511970         0.000000
   0          0.758367         -0.511970         0.000000
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1         -0.000000         -0.000042         0.000000
   2          0.000060          0.000021         0.000000
   3         -0.000060          0.000021         0.000000
------------------------------------------------------------

 Torch energy -76.388535 

Finished running 'compute_energy()' which traverses through torch routines
    FINAL STATE

    GEOMETRY (ANGSTROMS)

A01O1               -0.000000     0.086639     0.000000
A02H2               -0.758367    -0.511970     0.000000
A03H3                0.758367    -0.511970     0.000000
A01O1                5.047701    -0.041199     0.000000
A02H2                5.113439     0.896539     0.000000
A03H3                4.129507    -0.242679     0.000000
A01N1                0.000000     5.000000    -0.063177
A02H2                0.929426     4.912005     0.292603
A03H3               -0.540919     4.239091     0.292603
A04H4               -0.388507     5.848904     0.292603


    RESTART DATA

fragment H2O_L
  -2.767160e-09   1.964570e-02   0.000000e+00   2.580632e-02   0.000000e+00   0.000000e+00

fragment H2O_L
   5.000000e+00   0.000000e+00   0.000000e+00  -2.283185e+00   0.000000e+00   0.000000e+00

fragment NH3_L
   0.000000e+00   5.000000e+00   0.000000e+00   2.000000e+00   0.000000e+00   0.000000e+00


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0000969052
           POLARIZATION ENERGY    -0.0000464797
             DISPERSION ENERGY    -0.0001923500
     EXCHANGE REPULSION ENERGY     0.0000085895
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000

                  TOTAL ENERGY   -76.3886678809


                 ENERGY CHANGE    -0.0000039570
                  RMS GRADIENT     0.0000332152
              MAXIMUM GRADIENT     0.0000601206


OPTIMIZATION CONVERGED
SPECIAL FRAGMENT ENERGY MINIMIZATION JOB COMPLETED SUCCESSFULLY
WALL CLOCK TIME IS Mon Jul 15 04:02:35 2024
TOTAL RUN TIME IS 3 SECONDS
